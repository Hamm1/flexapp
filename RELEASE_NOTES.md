Upgraded dependancies and added some more tests.